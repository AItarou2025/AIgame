<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãŸã“ç„¼ãã‚’ç„¼ã“ã†ï¼ï¼ˆãƒ€ãƒŸãƒ¼ç´ æç‰ˆï¼‰</title>
  <style>
    body {
      font-family: "Arial", sans-serif;
      text-align: center;
      background: #ffe6cc;
      margin: 0;
      padding: 0;
    }
    h1 {
      margin: 20px 0 10px;
    }
    #controls {
      margin: 10px;
    }
    #game {
      display: grid;
      grid-template-columns: repeat(4, 100px);
      gap: 10px;
      justify-content: center;
      margin: 20px auto;
      max-width: 500px;
    }
    .tako {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 2px solid #333;
      cursor: pointer;
      background-size: cover;
      background-position: center;
      transition: transform 0.2s;
    }
    .tako:active {
      transform: scale(0.9);
    }
    #score, #time {
      font-size: 22px;
      margin: 10px;
    }
    #combo {
      font-size: 18px;
      color: red;
      margin: 5px;
    }
  </style>
</head>
<body>
  <h1>ãŸã“ç„¼ãã‚’ç„¼ã“ã†ï¼ï¼ˆãƒ€ãƒŸãƒ¼ç´ æç‰ˆï¼‰</h1>
  <div id="controls">
    <button id="startBtn">â–¶ ã‚²ãƒ¼ãƒ é–‹å§‹</button>
    <button id="bgmToggle">ğŸ”Š BGM ã‚ªãƒ³/ã‚ªãƒ•</button>
  </div>
  <div id="time">æ®‹ã‚Šæ™‚é–“: 30</div>
  <div id="score">ã‚¹ã‚³ã‚¢: 0</div>
  <div id="combo">ã‚³ãƒ³ãƒœ: 0</div>
  <div id="game"></div>

  <!-- åŠ¹æœéŸ³ã¨BGMï¼ˆGoogleå…¬å¼ã®ç„¡æ–™åŠ¹æœéŸ³ã‚’åˆ©ç”¨ï¼‰ -->
  <audio id="bgm" loop src="https://actions.google.com/sounds/v1/ambiences/restaurant_room.ogg"></audio>
  <audio id="seClick" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
  <audio id="sePerfect" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
  <audio id="seBurn" src="https://actions.google.com/sounds/v1/cartoon/siren_whistle.ogg"></audio>

  <script>
    const game = document.getElementById('game');
    const scoreDisplay = document.getElementById('score');
    const timeDisplay = document.getElementById('time');
    const comboDisplay = document.getElementById('combo');
    const startBtn = document.getElementById('startBtn');
    const bgmToggle = document.getElementById('bgmToggle');
    const bgm = document.getElementById('bgm');
    const seClick = document.getElementById('seClick');
    const sePerfect = document.getElementById('sePerfect');
    const seBurn = document.getElementById('seBurn');

    let score = 0;
    let combo = 0;
    let timeLeft = 30;
    let timer;
    let playing = false;

    const holes = [];
    const images = [
      "https://placehold.co/100x100/ffcccc/000000?text=ç”Ÿ",
      "https://placehold.co/100x100/ffff99/000000?text=åŠç„¼ã‘",
      "https://placehold.co/100x100/ccffcc/000000?text=ãƒ™ã‚¹ãƒˆ",
      "https://placehold.co/100x100/999999/ffffff?text=ç„¦ã’",
    ];

    function setupGame() {
      game.innerHTML = "";
      for (let i = 0; i < 12; i++) {
        const div = document.createElement('div');
        div.className = 'tako';
        div.dataset.level = 0;
        div.style.backgroundImage = `url(${images[0]})`;
        game.appendChild(div);
        holes.push(div);

        let level = 0;
        setInterval(() => {
          if (!playing) return;
          level++;
          if (level >= images.length) {
            level = images.length - 1;
          }
          div.dataset.level = level;
          div.style.backgroundImage = `url(${images[level]})`;
        }, 1000 + Math.random() * 500);

        div.addEventListener('click', () => {
          if (!playing) return;
          const currentLevel = parseInt(div.dataset.level);
          seClick.currentTime = 0;
          seClick.play();
          if (currentLevel === 2) { // ãƒ™ã‚¹ãƒˆ
            score += 10 + combo * 2;
            combo++;
            sePerfect.currentTime = 0;
            sePerfect.play();
          } else if (currentLevel === 3) { // ç„¦ã’
            score += 2;
            combo = 0;
            seBurn.currentTime = 0;
            seBurn.play();
          } else { // ç”Ÿ or åŠç„¼ã‘
            score -= 5;
            combo = 0;
          }
          scoreDisplay.textContent = `ã‚¹ã‚³ã‚¢: ${score}`;
          comboDisplay.textContent = `ã‚³ãƒ³ãƒœ: ${combo}`;
          // ãƒªã‚»ãƒƒãƒˆ
          div.dataset.level = 0;
          div.style.backgroundImage = `url(${images[0]})`;
        });
      }
    }

    function startGame() {
      score = 0;
      combo = 0;
      timeLeft = 30;
      playing = true;
      scoreDisplay.textContent = "ã‚¹ã‚³ã‚¢: 0";
      comboDisplay.textContent = "ã‚³ãƒ³ãƒœ: 0";
      timeDisplay.textContent = "æ®‹ã‚Šæ™‚é–“: 30";
      if (timer) clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        timeDisplay.textContent = `æ®‹ã‚Šæ™‚é–“: ${timeLeft}`;
        if (timeLeft <= 0) {
          clearInterval(timer);
          playing = false;
          alert(`çµ‚äº†ï¼ ã‚ãªãŸã®ã‚¹ã‚³ã‚¢ã¯ ${score} ç‚¹ã§ã—ãŸï¼`);
        }
      }, 1000);
    }

    startBtn.addEventListener('click', startGame);

    bgmToggle.addEventListener('click', () => {
      if (bgm.paused) {
        bgm.play();
      } else {
        bgm.pause();
      }
    });

    setupGame();
  </script>
</body>
</html>
