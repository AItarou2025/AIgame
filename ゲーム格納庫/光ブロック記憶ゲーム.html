<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è¨˜æ†¶ã‚¹ãƒ­ãƒƒãƒˆ</title>
<style>
    body {
        font-family: sans-serif;
        text-align: center;
        background: #111;
        color: #fff;
    }
    h1 {
        margin-top: 20px;
    }
    #grid {
        display: grid;
        grid-template-columns: repeat(3, 100px);
        gap: 10px;
        justify-content: center;
        margin: 30px auto;
    }
    .cell {
        width: 100px;
        height: 100px;
        background: #333;
        cursor: pointer;
        border-radius: 10px;
    }
    .cell.active {
        background: yellow;
    }
    .cell.selected {
        background: #4caf50;
    }
    button {
        font-size: 18px;
        padding: 10px 20px;
    }
</style>
</head>
<body>

<h1>è¨˜æ†¶ã‚¹ãƒ­ãƒƒãƒˆ</h1>
<p id="info">ã‚¹ã‚¿ãƒ¼ãƒˆã‚’æŠ¼ã—ã¦ãã ã•ã„</p>

<div id="grid"></div>

<button onclick="startGame()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>

<script>
const grid = document.getElementById("grid");
const info = document.getElementById("info");

let answer = [];
let selected = [];
let canSelect = false;

// ãƒã‚¹ç”Ÿæˆ
for (let i = 0; i < 9; i++) {
    const cell = document.createElement("div");
    cell.className = "cell";
    cell.dataset.index = i;
    cell.onclick = () => clickCell(i);
    grid.appendChild(cell);
}

function startGame() {
    answer = [];
    selected = [];
    canSelect = false;
    info.textContent = "è¦šãˆã¦ãã ã•ã„â€¦";

    const cells = document.querySelectorAll(".cell");
    cells.forEach(c => {
        c.classList.remove("active", "selected");
    });

    // ãƒ©ãƒ³ãƒ€ãƒ ã«3ãƒã‚¹é¸ã¶
    while (answer.length < 3) {
        const r = Math.floor(Math.random() * 9);
        if (!answer.includes(r)) answer.push(r);
    }

    // è¡¨ç¤º
    answer.forEach(i => {
        cells[i].classList.add("active");
    });

    // ä¸€ç¬å¾Œã«æ¶ˆã™
    setTimeout(() => {
        answer.forEach(i => {
            cells[i].classList.remove("active");
        });
        canSelect = true;
        info.textContent = "åŒã˜ãƒã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼";
    }, 1000);
}

function clickCell(i) {
    if (!canSelect) return;
    if (selected.includes(i)) return;

    selected.push(i);
    document.querySelectorAll(".cell")[i].classList.add("selected");

    if (selected.length === answer.length) {
        checkResult();
    }
}

function checkResult() {
    canSelect = false;

    const ok =
        selected.every(i => answer.includes(i)) &&
        answer.every(i => selected.includes(i));

    if (ok) {
        info.textContent = "ğŸ‰ æ­£è§£ï¼";
    } else {
        info.textContent = "âŒ ä¸æ­£è§£â€¦";
        // æ­£è§£ã‚’å†è¡¨ç¤º
        const cells = document.querySelectorAll(".cell");
        answer.forEach(i => cells[i].classList.add("active"));
    }
}
</script>

</body>
</html>
