<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>反射神経テストゲーム</title>
<style>
body{
  margin:0;
  background:#0f1724;
  color:#e6eef8;
  font-family:system-ui;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
}
#screen{
  width:400px;
  height:300px;
  background:#1e293b;
  border-radius:16px;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:24px;
  cursor:pointer;
}
#screen.wait{background:#475569}
#screen.ready{background:#22c55e}
#screen.tooSoon{background:#ef4444}
#result{margin-top:12px;font-size:20px;text-align:center}
</style>
</head>
<body>

<div>
  <div id="screen" class="wait">クリックしてスタート</div>
  <div id="result"></div>
</div>

<script>
(() => {
  const screen = document.getElementById('screen');
  const result = document.getElementById('result');

  let state = 'wait'; // wait, waiting, ready
  let startTime = 0;
  let timer = null;

  screen.addEventListener('click', () => {
    if(state === 'wait'){
      result.textContent = '';
      screen.textContent = '緑になるまで待ってください…';
      screen.className = 'wait';
      state = 'waiting';
      const delay = 2000 + Math.random() * 3000;
      timer = setTimeout(() => {
        state = 'ready';
        startTime = performance.now();
        screen.textContent = 'クリック！';
        screen.className = 'ready';
      }, delay);
    }
    else if(state === 'waiting'){
      clearTimeout(timer);
      state = 'wait';
      screen.textContent = '早すぎ！\nクリックして再挑戦';
      screen.className = 'tooSoon';
    }
    else if(state === 'ready'){
      const reaction = Math.floor(performance.now() - startTime);
      result.textContent = `反応時間：${reaction} ms`;
      state = 'wait';
      screen.textContent = 'もう一度テスト';
      screen.className = 'wait';
    }
  });
})();
</script>

</body>
</html>